# linux文件说明

【/ 】系统的根目录
【/bin】 存放可执行文件
【/boot 】系统引导文件夹
【/dev】 存放设备文件
【/etc 】系统、软件配置相关文件
【/home 】用户文件的根目录，下面的每一个文件夹代表一个普通用户
【/root】 系统管理员、root用户的主目录
【/tmp】 临时文件夹											放软件压缩包
【/usr 】系统应用程序存放位置							软连接创建位置(相当于快捷方式):/usr/local/bin/
【/var 】存放数据文件，比如日志文件
【/opt 】额外安装的可选应用程序位置				安装应用位置
【/lib】 共享库，存放动态链接库

------





#  Vi 和Vim编辑器 



####  vi 和 vim 的基本介绍 

-  Linux 系统会内置 vi 文本编辑器
-  Vim 具有程序编辑的能力，可以看做是 Vi 的增强版本，可以主动的以字体颜色辨别语法的正确性，方便程序设计。代码补完、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。 

------





####  vi 和 vim 常用的三种模式 

- **正常模式** 以 vim 打开一个档案就直接进入一般模式了(这是默认的模式)。在这个模式中， 你可以使用『上下左右』按键来移动光标，你可以使用『删除字符』或『删除整行』来处理档案内容， 也可以使用『复制、粘贴』来处理你的文件数据。 
- **插入模式** 按下 i, I, o, O, a, A, r, R 等任何一个字母之后才会进入编辑模式, 一般来说按 i 即可. 
- **命令行模式** 输入 esc 再输入：在这个模式当中， 可以提供你相关指令，完成读取、存盘、替换、离开vim、显示行号等的动作则是在此模式中达成的！ 

------





####  各种模式的相互切换 

![](.\linux.assets\各种模式的相互切换.png)

------





####  vi 和 vim 快捷键 

1. 复制当前行 yy , 
2. 复制当前光标行向下的 5 行 5yy
3. 粘贴 p
4.  删除当前行 dd 
5.  删除当前光标行向下的 5 行 5dd 
6.  在文件中查找某个单词 [命令行下 / 查找的关键字 ， 回车 查找 , 输入 n 就是查找下一个] 
7. 设置文件的行号，取消文件的行号.[命令行下 : set nu 和 :set nonu] 
8.  编辑 /etc/profile 文件，在一般模式下, 使用快捷键到该文档的最末行[G]和最首行[gg] 
9.  在一个文件中输入 "hello" ,在一般模式下, 然后又撤销这个动作 u
10.  编辑 /etc/profile 文件，在一般模式下, 并将光标移动到 , 输入 20,再输入 shift+g 

------





# linux基本命令

####  关机&重启命令 

1. shutdown –h now 立该进行关机 
2. shudown -h 1 "hello, 1 分钟后会关机了" 
3. shutdown –r now 现在重新启动计算机 
4. halt 关机，作用和上面一样. 
5. reboot 现在重新启动计算机 
6. sync 把内存的数据同步到磁盘 

 **注意细节** 

1. 不管是重启系统还是关闭系统，首先要运行 sync 命令，把内存中的数据写到磁盘中
2.  目前的 shutdown/reboot/halt 等命令均已经在关机前进行了 sync ， 老韩提醒: 小心驶得万年船 

------





#### 用户登录和注销

1.  登录时尽量少用 root 帐号登录，因为它是系统管理员，最大的权限，避免操作失误。可以利用普通用户登录，登录后再用”su - 用户名’命令来切换成系统管理员身份. 
2. 在提示符下输入 logout 即可注销用户  

 **注意细节** 

1. logout 注销指令在图形运行级别无效，在运行级别 3 下有效. 

------





#### 用户

 ###### 添加用户 

 	useradd 用户名 

 **注意细节** 

1.  当创建用户成功后，会自动的创建和用户同名的家目录
2.  也可以通过 useradd -d 指定目录 新的用户名，给新创建的用户指定家目录 

------





 ###### 设置/修改密码 

 	passwd 用户名 

**注意细节** 

1. 如果没有指定用户名,则修改当前登录用户

------



###### 给用户全部权限

sudo visudo		运行

找到:%sudo   ALL=(ALL:ALL) ALL

添加:用户名 ALL=(ALL:ALL) ALL



######  删除用户 

​	userdel 用户名  			   	 删除用户 

​	userdel -r 用户名 				 删除用户以及用户主目录 

------





###### 查询用户信息指令 

 	id 用户名 

------





######  切换用户 

 	su - 切换用户名 

**注意细节** 

1. 从权限高的用户切换到权限低的用户，不需要输入密码，反之需要。
2. 当需要返回到原来用户时，使用 exit/logout 指令 

------







######  查看当前用户/登录用户 

 who am I			查看的是登录 linux 系统的用户

------





######  用户组-新增组 

​	groupadd 组名

 **案例演示** 

- 增加用户时直接加上组 
- 指令(基本语法) : useradd –g 用户组 用户名 
- 增加一个用户 zwj, 直接将他指定到 wudang 
- groupadd wudang 
- useradd -g wudang zwj 

------



###### 用户组-删除组 

​	groupdel 组名 			 

------



###### 用户组-修改组 

​	 usermod –g 用户组 用户名 

 **案例演示** 

- 创建一个组 mojiao 
- 把 zwj 放入到 mojiao 
- 指令: usermod -g mojiao zwj 

------



###### 用户和组相关文件 

1.  /etc/passwd 文件
   - 用户（user）的配置文件，记录用户的各种信息 ,
   - 每行的含义：用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录 Shell 
2. /etc/shadow 文件 
   - 口令的配置文件,
   - 每行的含义：登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志
3. /etc/group 文件 
   - 组(group)的配置文件，记录 Linux 包含的组的信息 
   - 每行含义：组名:口令:组标识号:组内用户列表 

------







####  运行级别 

运行级别说明： 

0 ：关机 
1 ：单用户【找回丢失密码】 
2：多用户状态没有网络服务 
3：多用户状态有网络服务 
4：系统未使用保留给用户 
5：图形界面 
6：系统重启 

 常用运行级别是 3 和 5 ，也可以指定默认运行级别 

------



###### 切换运行级别

**命令**：init [0123456] 

**应用案例**： 通过 init 来切换不同的运行级别，比如动 5-3 ， 然后关机。 

- init 3
- init 0

------



###### 获取默认运行级别

**命令**：systemctl get-default 

------



###### 修改默认运行级别

**命令**：systemctl set-default multi-user.target		修改默认运行级别为 3 

**说明:** 在 centos7 以前， /etc/inittab 文件中 . 
	进行了简化 ，如下:
		multi-user.target: analogous to runlevel 3 		代表 3 运行级别
		graphical.target: analogous to runlevel 5 			代表 5 运行级别

------







####  帮助指令

###### man 获得帮助信息 

- 基本语法：man [命令或配置文件]（功能描述：获得帮助信息） 
- 案例：查看 ls 命令的帮助信息 man ls 
- 在 linux 下，隐藏文件是以 .开头 , 选项可以组合使用 比如 ls -al, 比如 ls -al /root 

------



###### help 获得 shell 内置命令的帮助信息 

------





####  文件目录类 

######  pwd 指令 

- 基本语法 ：pwd (功能描述：显示当前工作目录的绝对路径) 
- 应用实例：显示当前工作目录的绝对路径 

------



######  ls 指令 

- 基本语法：ls [选项] [目录或是文件]
- 常用选项 
  - -a ：显示当前目录所有的文件和目录，包括隐藏的。 
  - -l ：以列表的方式显示信息 

------



######  cd 指令 

- 基本语法：cd [参数] (功能描述：切换到指定目录) 
- 应用实例 
  1. 使用绝对路径切换到 root 目录 ， cd /root 
  2. 使用相对路径到/root 目录, 比如在 /home/tom , cd ../../root 
  3. 表示回到当前目录的上一级目录 , cd .. 
  4. 回到家目录 , cd ~ 

-----



###### mkdir 指令 

- 描述: mkdir 指令用于创建目录 

- 基本语法：mkdir [选项] 要创建的目录 

- 常用选项 -p ：创建多级目录 

-  应用实例 

  1. 创建一个目录 /home/dog 

     mkdir /home/dog 

  2. 创建多级目录 /home/animal/tiger 

     mkdir -p /home/animal/tiger 

------



######  rmdir 指令 

- 描述:  删除空目录 

-  基本语法: rmdir [选项] 要删除的空目录 
-  使用细节
  -  rmdir 删除的是空目录，如果目录下有内容时无法删除的。 
  - 如果需要删除非空目录，需要使用 rm -rf 要删除的目录 比如： rm -rf /home/animal 

-----



######  touch 指令 

- 描述:  创建空文件 

-  基本语法:  touch 文件名称 

-----



######  cp 指令 

- 描述:   拷贝文件到指定目录  

-  基本语法:  cp [选项]    要拷贝文件源    拷贝到的路径

-  常用选项 :

  - -r ：递归复制整个文件夹 

-  应用实例 

  -  将 /home/hello.txt 拷贝到 /home/bbb 目录下 

    cp hello.txt /home/bbb 

  - 递归复制整个文件夹，举例, 比如将 /home/bbb 整个目录， 拷贝到 /opt 

    cp -r /home/bbb /opt 

-  使用细节:

  -  强制覆盖不提示的方法：\cp , 	\cp -r /home/bbb /opt 

----



######   rm 指令 

- 描述: 移除文件或目录  

-  基本语法:   rm [选项] 要删除的文件或目录 

-  常用选项 :

  -  -r ：递归删除整个文件夹 
  - -f ： 强制删除不提示 

- 应用实例 

  -  将 /home/hello.txt 删除 ,

     rm /home/hello.txt 

  -  递归删除整个文件夹 /home/bbb , 

    rm -rf /home/bbb [删除整个文件夹，不提示] 

- 使用细节:

  -  强制删除不提示的方法：带上 -f 参数即可 

-----



######   mv 指令 

- 描述:  移动文件与目录或重命名   

- 基本语法:   

  - mv oldNameFile newNameFile (功能描述：重命名) 
  - mv  /temp/movefile  /targetFolder (功能描述：移动文件) 

- 应用实例 

  -   将 /home/cat.txt 文件 重新命名为 pig.txt 

     mv /home/cat.txt /home/pig.txt

  -   将 /home/pig.txt 文件 移动到 /root 目录下 

    mv /home/pig.txt /root

  -  移动整个目录 , 比如将 /opt/bbb 移动到 /home 下 

    mv /opt/bbb /home/ 

-----



######   cat 指令 

- 描述:   查看文件内容    

- 基本语法:    cat [选项] 要查看的文件 

-  常用选项 :

  -  -n ：显示行号 

- 应用实例 

  - 查看文件 /etc/profile 文件内容，并显示行号 

     cat -n /etc/profile

- 使用细节:

  - cat 只能浏览文件，而不能修改文件，为了浏览方便，一般会带上 管道命令 | more 
  - cat -n /etc/profile | more [进行交互] 

-----



######    more 指令 

- 描述:    more 指令是一个基于 VI 编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。more 指令中内置了若干快捷键(交互的指令) 

- 基本语法:     more 要查看的文件 

- 交互指令:

  | 操作          | 功能说明                              |
  | ------------- | ------------------------------------- |
  | 空白键(space) | 代表向下翻一页                        |
  | Enter         | 代表向下翻一行                        |
  | q             | 代表立刻离开 more ,不再显示该文件内容 |
  | Ctrl+F        | 向下滚动一屏                          |
  | Ctrl+B        | 返回上一屏                            |
  | =             | 输出当前行号                          |
  | :f            | 输出文件名和当前行的行号              |

- 应用实例 

  -  采用 more 查看文件 /etc/profile 文件内容 

     more /etc/profile

-----



######     less 指令 

- 描述:  less 指令用来分屏查看文件内容，它的功能与 more 指令类似，但是比 more 指令更加强大，支持各种显示终端。less指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率 

- 基本语法: less 要查看的文件 

- 交互指令:

  | 操作          | 功能说明                                           |
  | ------------- | -------------------------------------------------- |
  | 空白键(space) | 代表向下翻一页                                     |
  | pagedown      | 代表向下翻一页                                     |
  | pageup        | 代表向上翻一页                                     |
  | /字符串       | 向下搜索 字符串 的功能; n : 向下查找; N : 向上查找 |
  | ?字符串       | 向上搜索 字符串 的功能; n : 向上查找; N : 向下查找 |
  | q             | 代表立刻离开 less                                  |

- 应用实例 

  - 采用 less 查看一个 大文件文件 /opt/杂文.txt 

    less /opt/杂文.txt 

-----



######    echo 指令 

- 描述:   输出内容到控制台    

- 基本语法:    echo [选项] [输出内容] 

- 应用实例 

  - 使用 echo 指令输出环境变量, 比如输出 $HOSTNAME 

    echo $HOSTNAME 

  - 使用 echo 指令输出 hello,world! 

    echo "hello,world! "

----



######     head 指令 

- 描述:    head 用于显示文件的开头部分内容，默认情况下 head 指令显示文件的前 10 行内容     

- 基本语法:   

  -  head 文件 (功能描述：查看文件头 10 行内容) 
  -  head -n 5 文件 (功能描述：查看文件头 5 行内容，5 可以是任意行数) 

- 应用实例 

  -  查看/etc/profile 的前面 5 行代码  

     head -n 5 /etc/profile 

----



######      tail 指令 

- 描述:  tail 用于输出文件中尾部的内容，默认情况下 tail 指令显示文件的前 10 行内容 

- 基本语法:   

  -  tail 文件 （功能描述：查看文件尾 10 行内容） 
  -  tail -n 5 文件 （功能描述：查看文件尾 5 行内容，5 可以是任意行数） 
  -  tail -f 文件 （功能描述：实时追踪该文档的所有更新, Ctrl + c 退出） 

- 应用实例 

  - 查看/etc/profile 最后 5 行的代码 

     tail -n 5 /etc/profile 

  -  实时监控 mydate.txt , 看看到文件有变化时，是否看到， 实时的追加 hello,world 

     tail -f /home/mydate.txt 

----



######  \> 指令 和 >> 指令 

- 描述: \> 输出重定向和 >> 追加 

- 基本语法:   

  - ls -l >文件 （功能描述：列表的内容写入文件 a.txt 中（覆盖写）） 
  - ls -al >>文件 （功能描述：列表的内容追加到文件 aa.txt 的末尾） 
  - cat 文件 1 > 文件 2 （功能描述：将文件 1 的内容覆盖到文件 2） 
  - echo "内容">> 文件 (追加) 

- 应用实例 

  -  将 /home 目录下的文件列表 写入到 /home/info.txt 中, 覆盖写入 

     ls -l /home > /home/info.txt [如果 info.txt 没有，则会创建] 

  -  将当前日历信息 追加到 /home/mycal 文件中 

     cal >> /home/mycal 

----



######  ln 指令 

- 描述: 软链接也称为符号链接，类似于 windows 里的快捷方式，主要存放了链接其他文件的路径 

- 基本语法:    ln -s [原文件或目录] [软链接名] （功能描述：给原文件创建一个软链接） 

- 应用实例 

  -  在/home 目录下创建一个软连接 myroot，连接到 /root 目录 

     ln -s /root /home/myroot 

  -  删除软连接 myroot  

     rm /home/myroot 

- 细节说明:  当我们使用 pwd 指令查看目录时，仍然看到的是软链接所在目录。 

----



######   history 指令 

- 描述: 查看已经执行过历史命令,也可以执行历史指令 

- 基本语法: history （功能描述：查看已经执行过历史命令）  

- 应用实例 

  -  显示所有的历史命令 

     history 

  -  显示最近使用过的 10 个指令

     history 10 

  -  执行历史编号为 5 的指令 

    !5

- 细节说明:  当我们使用 pwd 指令查看目录时，仍然看到的是软链接所在目录。 

----







#### 时间日期类 

######  date 指令-显示当前日期 

- 基本语法: 

  - date （功能描述：显示当前时间） 
  - date +%Y（功能描述：显示当前年份） 
  - date +%m（功能描述：显示当前月份） 
  - date +%d （功能描述：显示当前是哪一天） 
  - date "+%Y-%m-%d %H:%M:%S"（功能描述：显示年月日时分秒） 

- 应用实例 

  -  显示当前时间信息 

     date 

  -  显示当前时间年月日 

     date "+%Y-%m-%d" 

  -  显示当前时间年月日时分秒  

     date "+%Y-%m-%d %H:%M:%S" 

----



###### date 指令- 设置日期  

- 基本语法:  date -s 字符串时间 

- 应用实例 

  -  设置系统当前时间 ， 比如设置成 2020-11-03 20:02:10 

     date -s “2020-11-03 20:02:10” 

----



######  cal 指令 -  查看日历 

- 基本语法:  cal [选项] （功能描述：不加选项，显示本月日历） 

- 应用实例 

  -  显示当前日历 

     cal 

  -  显示 2020 年日历 

     cal 2020 

----







####  搜索查找类 

######  find 指令 

- 描述: 将从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端 

- 基本语法: find [搜索范围] [选项] 

- 选项说明

  | 选项            | 功能                         |
  | --------------- | ---------------------------- |
  | -name<查询方式> | 按照指定文件名查找文件       |
  | -user<用户名>   | 查找属于指定用户名的所有文件 |
  | -size<文件大小> | 按照指定的文件大小查找文件   |

  

- 应用实例 

  -  按文件名：根据名称查找/home 目录下的 hello.txt 文件 

     find /home -name hello.txt 

  -  按拥有者：查找/opt 目录下，用户名称为 nobody 的文件 

     find /opt -user nobody 

  -  查找整个 linux 系统下大于 200M 的文件（+n 大于 -n 小于 n 等于, 单位有 k,M,G） 

     find / -size +200M 

----



######  locate 指令 

- 描述: 可以快速定位文件路径。locate 指令利用事先建立的系统中所有文件名称及路径的locate 数据库实现快速定位给定的文件。Locate 指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新 locate 时刻 

-  基本语法 : locate 搜索文件 

-  特别说明 : 由于 locate 指令基于数据库进行查询，所以第一次运行前，必须使用 updatedb 指令创建 locate 数据库。 

-  应用实例 :

  -  请使用 locate 指令快速定位 hello.txt 文件所在目录 

    locate hello.txt

----



######  which 指令 

- 描述:  可以查看某个指令在哪个目录下
-  基本语法 :  which 指令名称
-  应用实例 :
  -  请使用 which 查看 ls 指令在哪个目录 

-----



######  grep 指令和 管道符号 | 

- 描述: 过滤查找 ， 管道符，“|”，表示将前一个命令的处理结果输出传递给后面的命令处理。 

-  基本语法 : grep [选项] 查找内容 源文件 

- 选项说明

  | 选项 | 功能             |
  | ---- | ---------------- |
  | -n   | 显示匹配行及行号 |
  | -i   | 忽略字母大小写   |

- 应用实例:

  -  请在 hello.txt 文件中，查找 "yes" 所在行，并且显示行号 
    1.  cat /home/hello.txt | grep "yes" 
    2.  grep -n "yes" /home/hello.txt 

----







####  压缩和解压类 

######  gzip/gunzip 指令 (只能压缩文件)

- 描述: gzip 用于压缩文件， gunzip 用于解压的 **(源文件会消失)**

-  基本语法 : 

  -  gzip 文件 （功能描述：压缩文件，只能将文件压缩为*.gz 文件） 
  -  gunzip 文件.gz （功能描述：解压缩文件命令） 

- 应用实例:

  -  gzip 压缩， 将 /home 下的 hello.txt 文件进行压缩 

     gzip /home/hello.txt 

  -  gunzip 解压缩， 将 /home 下的 hello.txt.gz 文件进行解压缩 

     gunzip /home/hello.txt.gz 

-----



######  zip/unzip 指令 

- 描述: zip 用于压缩文件， unzip 用于解压的，这个在项目打包发布中很有用的 **(源文件不会消失)**

-  基本语法 : 

  - zip [选项] XXX.zip 将要压缩的内容（功能描述：压缩文件和目录的命令） 
  - unzip [选项] XXX.zip （功能描述：解压缩文件） 

- 常用选项:

  -  zip 常用选项 

     -r：递归压缩，即压缩目录 

  -  unzip 的常用选项 

     -d<目录> ：指定解压后文件的存放目录 

- 应用实例:

  -  将 /home 下的 所有文件/文件夹进行压缩成 myhome.zip 

     zip -r myhome.zip /home/ [将 home 目录及其包含的文件和子文件夹都压缩] 

  -  将 myhome.zip 解压到 /opt/tmp 目录下 

     mkdir /opt/tmp 

     unzip -d /opt/tmp /home/myhome.zip 

-----



######  tar 指令 

- 描述: 打包指令，最后打包后的文件是 .tar.gz 的文件。  **(源文件不会消失)**

-  基本语法 :  tar [选项] XXX.tar.gz 打包的内容 (功能描述：打包目录，压缩后的文件格式.tar.gz) 

- 常用选项:

  | 选项 | 功能               |
  | ---- | ------------------ |
  | -c   | 产生.tar打包文件   |
  | -v   | 显示详细信息       |
  | -f   | 指定压缩后的文件名 |
  | -z   | 打包同时压缩       |
  | -x   | 解包.tar文件       |

- 应用实例:

  -  压缩多个文件，将 /home/pig.txt 和 /home/cat.txt 压缩成 pc.tar.gz 

     tar -zcvf pc.tar.gz /home/pig.txt /home/cat.txt 

  -  将/home 的文件夹 压缩成 myhome.tar.gz  

     tar -zcvf myhome.tar.gz /home 

  -  将 pc.tar.gz 解压到当前目录 

     tar -xvf pc.tar.gz 

  -  将myhome.tar.gz 解压到 /opt/tmp2目录下 

    -  mkdir /opt/tmp2 
    -  tar -xvf /home/myhome.tar.gz -C /opt/tmp2 

-----











# 组管理和权限管理 

####  Linux 组基本介绍 

​		在 linux 中的每个用户必须属于一个组，不能独立于组外。在 linux 中每个文件 有所有者、所在组、其它组		的概念。 

1. 所有者 
2. 所在组 
3. 其它组 
4. 改变用户所在的组 

------





####  文件/目录 所有者 

######  查看文件的所有者 

-  指令：ls –ahl 

-----



######  修改文件所有者 

-  指令：

  - chown 用户名 文件名 
  -  chown 用户名:组名 文件/目录 改变所有者和所在组 
  -  -R 如果是目录 则使其下所有子文件或目录递归生效 

-  应用案例: 

  - 使用 root 创建一个文件 apple.txt ，然后将其所有者修改成 tom 

     chown tom apple.txt 

  -  将 /home/test 目录下所有的文件和目录的所有者都修改成 tom 

     chown -R tom /home/test 

----





####  组的创建 

-  指令： groupadd 组名 

-  应用案例: 

  -  创建一个组  monster 

     groupadd monster 

  -  创建一个用户 fox ，并放入到 monster 组中 

     useradd -g monster fox 

-----





#### 文件/目录 所在组 

​	 当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组(默认)。 

######  查看文件/目录所在组 

-  指令：ls –ahl 

-----



######  修改文件/目录所在的组 

-  指令： chgrp 组名 文件名 

-  应用案例: 

  -  使用 root 用户创建文件 orange.txt ,看看当前这个文件属于哪个组，然后将这个文件所在组，修改到fruit 组。 

    1. groupadd fruit 
    2. touch orange.txt 
    3. 看看当前这个文件属于哪个组 -> root 组 
    4. chgrp fruit orange.txt 

  -  请将 /home/test 目录下所有的文件和目录的所在组都修改成 shaolin(少林) 

     chgrp -R shaolin /home/test 

----





####  其它组 

 	除文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组 

-----





####  改变用户所在组 

- 描述: 在添加用户时，可以指定将该用户添加到哪个组中，同样的用 root 的管理权限可以改变某个用户所在的组。 

- 指令

  -  usermod –g 新组名 用户名 
  - usermod –d 目录名 用户名 改变该用户登陆的初始目录。特别说明：用户需要有进入到新目录的权限。 

- 实例

  -  将 zwj 这个用户从原来所在组，修改到 wudang 组 

     usermod -g wudang zwj 

-----





####  权限的基本介绍 

 ls -l 中显示的内容如下： -rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc 

-  0-9 位说明 
  - 第 0 位确定文件类型(d, - , l , c , b) 
    - l 是链接，相当于 windows 的快捷方式 
    - d 是目录，相当于 windows 的文件夹 
    - c 是字符设备文件，鼠标，键盘 
    - b 是块设备，比如硬盘 
  - 第 1-3 位确定所有者（该文件的所有者）拥有该文件的权限。---User 
  - 第 4-6 位确定所属组（同用户组的）拥有该文件的权限，---Group 
  - 第 7-9 位确定其他用户拥有该文件的权限 ---Other 

-----





####  rwx 权限详解 

######  rwx 作用到文件 

1. [ r ]代表可读(read): 可以读取,查看 
2. [ w ]代表可写(write): 可以修改,但是不代表可以删除该文件,删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件. 
3. [ x ]代表可执行(execute):可以被执行 

-----



######  rwx 作用到目录 

1. [ r ]代表可读(read): 可以读取，ls 查看目录内容
2. [ w ]代表可写(write): 可以修改, 对目录内创建+删除+重命名目录
3. [ x ]代表可执行(execute):可以进入该目录 

------





####  文件及目录权限实际案例 

-  ls -l 中显示的内容如下：

  -rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc 

- 10个字符确定不同用户能对文件干什么 

  - 第一个字符代表文件类型： - l d c b 
  - 其余字符每 3 个一组(rwx) 读(r) 写(w) 执行(x) 
  - 第一组 rwx : 文件拥有者的权限是读、写和执行 
  - 第二组 rw- : 与文件拥有者同一组的用户的权限是读、写但不能执行 
  - 第三组 r-- : 不与文件拥有者同组的其他用户的权限是读不能写和执行 

- 可用数字表示为: r=4,w=2,x=1 因此 rwx=4+2+1=7 , 数字可以进行组合 

-  其它说明 

  - 1 文件：硬连接数或 目录：子目录数 
  - root 用户 
  - root 组 
  -  1213 文件大小(字节)，如果是文件夹，显示 4096 字节 
  - Feb 2 09:39 最后修改日期 
  - abc 文件名 

-------





#### chmod - 修改权限

-  基本说明： 通过 chmod 指令，可以修改文件或者目录的权限。 

######  \+ 、-、= 变更权限 

-  参数数 : u:所有者 g:所有组 o:其他人 a:所有人(u、g、o 的总和) 

  - chmod u=rwx,g=rx,o=x 文件/目录名 
  - chmod o+w 文件/目录名 
  - chmod a-x 文件/目录名 

-  案例演示 

  - 给 abc 文件 的所有者读写执行的权限，给所在组读执行权限，给其它组读执行权限。

    chmod u=rwx,g=rx,o=rx abc 

  - 给 abc 文件的所有者除去执行的权限，增加组写的权限 

    chmod u-x,g+w abc 

  - 给 abc 文件的所有用户添加读的权限 

    chmod a+r abc 

-----



######  通过数字变更权限 

​	r=4 w=2 x=1 	rwx=4+2+1=7 

​	chmod u=rwx,g=rx,o=x 文件/目录名

​	相当于 chmod 751 文件/目录名 

- 案例演示 

  -  将 /home/abc.txt 文件的权限修改成 rwxr-xr-x, 使用给数字的方式实现 

     chmod 755 /home/abc.txt 

--------







#  定时任务调度 

#### crond 任务调度 

##### crontab 进行 定时任务的设置 

###### 概述: 

-  任务调度：是指系统在某个时间执行的特定的命令或程序。 
- 任务调度分类：
  1. 系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等 
  2. 个别用户工作：个别用户可能希望执行某些程序，比如对 mysql 数据库的备份。 

-----



###### 基本语法 :

 crontab [选项] 

----



###### 常用选项 :

| 指令 | 描述                            |
| ---- | ------------------------------- |
| -e   | 编辑 crontab 任务               |
| -l   | 查询 crontab 任务               |
| -r   | 删除当前用户所有的 crontab 任务 |

-----



###### 常用案例:

- crontab –e：编辑 crontab 任务 

- crontab –r：终止任务调度。

- crontab –l：列出当前有那些任务调度 

- service crond restart [重启任务调度] 

- 快速入门 :

  设置任务调度文件：/etc/crontab ----暂时忽略

  设置个人任务调度。执行 crontab –e 命令。 

  接着输入任务到调度文件 

  如：*/1 * * * * ls –l /etc/ > /tmp/to.txt 

  意思说每小时的每分钟执行 ls –l /etc/ > /tmp/to.txt 命令 

  -  参数细节说明 

    | 项目       | 含义                 | 范围                  |
    | ---------- | -------------------- | --------------------- |
    | 第一个 "*" | 一小时当中的第几分钟 | 0-59                  |
    | 第二个 "*" | 一天当中的第几个小时 | 0-23                  |
    | 第三个 "*" | 一个月当中的第几天   | 1-31                  |
    | 第四个 "*" | 一年当中的第几月     | 1-12                  |
    | 第五个 "*" | 一周当中的星期几     | 0-7(0和7都代表星期日) |

  -  特殊符号的说明 

    | 特殊符号 | 含义                                                         |
    | -------- | ------------------------------------------------------------ |
    | *        | 代表任何时间。比如第一个“*就代表—小时中每分钟都执行一次的意思。 |
    | ,        | 代表不连续的时间。比如“08,12,16***命令”，就代表在每天的8点0分，12点0分，16点0分都执行一次命令 |
    | -        | 代表连续的时间范围。比如“05 * *1-6命令”，代表在周一到周六的凌晨5点0分执行命令 |
    | */n      | 代表每隔多久执行一次。比如“*/10 * ***命令”，代表每隔10分钟就执行一遍命令 |

  -  特殊时间执行案例 

    注意:星期几和几号最好不要同时出现，因为他们定义的都是天。非常容易让管理员混乱。

    | 时间              | 含义                                               |
    | ----------------- | -------------------------------------------------- |
    | 45 22 * * * 命令  | 在22点45分执行命令                                 |
    | 0 17 * * 1 命令   | 每周1的17点0分执行命令                             |
    | 0 5 1,15 * * 命令 | 每月1号和15号的凌晨5点0分执行命令                  |
    | 40 4 * * 1-5 命令 | 每周一到周五的凌晨4点40分执行命令                  |
    | */10 4 * * * 命令 | 每天的凌晨4点，每隔10分钟执行一次命令(只是4点执行) |
    | 0 0 1,15 * 1 命令 | 每月1号和15号，每周1的0点0分都会执行命令。         |

-----



###### 应用实例

  1. 每隔 1 分钟，就将当前的日期信息，追加到 /tmp/mydate 文件中 

     */1 * * * * date >> /tmp/mydate

  2. 每隔 1 分钟， 将当前日期和日历都追加到 /home/mycal 文件中

     - vim /home/my.sh 写入内容 date >> /home/mycal 和 cal >> /home/mycal
     - 给 my.sh 增加执行权限，chmod u+x /home/my.sh 
     - crontab -e 
     - */1 * * * * /home/my.sh

  3. 每天凌晨 2:00 将 mysql 数据库 testdb ，备份到文件中。

     提示: 指令为 mysqldump -u root -p 密码 数据库 > /home/db.bak 

     - crontab -e 
     - 0 2 * * * mysqldump -u root -proot testdb > /home/db.bak 

------







####  at 定时任务 

###### 基本介绍 :

1.  at 命令是一次性定时计划任务，at 的守护进程 atd 会以后台模式运行，检查作业队列来运行。
2. 默认情况下，atd 守护进程每 60 秒检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，则运行此作业。
3. at 命令是一次性定时计划任务，执行完一个任务后不再执行此任务了 
4. 在使用 at 命令的时候，一定要保证 atd 进程的启动 , 可以使用相关指令来查看 ps -ef | grep atd //可以检测 atd 是否在运行 

-----



######  基本语法

- at [选项] [时间] 
- Ctrl + D 结束 at 命令的输入， 输出两次 
- atq        查询全部任务
- atrm 编号      删除任务

-----



######  命令选项 

| 选项          | 含义                                                     |
| ------------- | -------------------------------------------------------- |
| -m            | 当指定的任务被完成后，将给用户发送邮件，即使没有标准输出 |
| -I            | atq的别名                                                |
| -d            | atrm的别名                                               |
| -v            | 显示任务将被执行的时间                                   |
| -c            | 打印任务的内容到标准输出                                 |
| -V            | 显示版本信息                                             |
| -q <队列>     | 使用指定的队列                                           |
| -f <文件>     | 从指定文件读入任务而不是从标准输入读入                   |
| -t <时间参数> | 以时间参数的形式提交要运行的任务                         |



-----



######  时间定义 

1. 接受在当天的 hh:mm（小时:分钟）式的时间指定。假如该时间已过去，那么就放在第二天执行。例如：04:00
2. 使用 midnight（深夜），noon（中午），teatime（饮茶时间，一般是下午 4 点）等比较模糊的词语来指定时间。
3. 采用 12 小时计时制，即在时间后面加上 AM（上午）或 PM（下午）来说明是上午还是下午。例如：12pm
4. 指定命令执行的具体日期，指定格式为 month day（月 日）或 mm/dd/yy（月/日/年）或dd.mm.yy（日.月.年），指定的日期必须跟在指定时间的后面。 例如：04:00 2021-03-1 
5. 使用相对计时法。指定格式为：now + count time-units ，now 就是当前时间，time-units 是时间单位，这里能够是minutes（分钟）、hours（小时）、days（天）、weeks（星期）。count 是时间的数量，几天，几小时。例如：now+5minutes
6. 直接使用 today（今天）、tomorrow（明天）来指定完成命令的时间 

-----



######  应用实例 

1. 2 天后的下午 5 点执行 /bin/ls /home										  ![1670673294184](.\linux.assets\at-定时任务-应用实例-1.png)

2. atq 命令来查看系统中没有执行的工作任务                    ![1670672580855](.\linux.assets\at-定时任务-应用实例-2.png)

3. 明天 17 点钟，输出时间到指定文件内 比如 /root/date100.log ![1670673204545](.\linux.assets\at-定时任务-应用实例-3.png)

4. 2 分钟后，输出时间到指定文件内 比如 /tmp/date200.log ![1670673638676](.\linux.assets\at-定时任务-应用实例-4.png)

5. 删除已经设置的任务 ,

   atrm 编号 

   atrm 3 					表示将 job 队列，编号为 3 的 job 删除. 

   删除前![1670674123325](.\linux.assets\at-定时任务-应用实例-5.png)

   删除后![1670674176785](.\linux.assets\at-定时任务-应用实例-6.png)

-------









#  Linux 磁盘分区、挂载 

####  原理介绍 

1. Linux 来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构, Linux中每个分区都是用来组成整个文件系统的一部分。
2. Linux 采用了一种叫“载入”的处理方法，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。 

------





####  硬盘说明 

1. Linux 硬盘分 IDE 硬盘和 SCSI 硬盘，目前基本上是 SCSI 硬盘
2. 对于 IDE 硬盘，驱动器标识符为“hdx~”,其中“hd”表明分区所在设备的类型，这里是指IDE 硬盘了。“x”为盘号（a为基本盘，b 为基本从属盘，c 为辅助主盘，d 为辅助从属盘）,“~”代表分区，前四个分区用数字1 到4 表示，它们是主分区或扩展分区，从 5 开始就是逻辑分区。例，hda3 表示为第一个 IDE 硬盘上的第三个主分区或扩展分区,hdb2表示为第二个 IDE 硬盘上的第二个主分区或扩展分区。
3. 对于 SCSI 硬盘则标识为“sdx~”，SCSI 硬盘是用“sd”来表示分区所在设备的类型的，其余则和IDE 硬盘的表示方法一样                                                                       ![1670983798084](.\linux.assets\linux-硬盘说明-1.png)

-------







####  查看所有设备挂载命令

 命令 ：lsblk 或者 lsblk -f 

-----







####  挂载的经典案例 

######  如何增加一块硬盘 

1.  虚拟机添加硬盘 
2. 分区 
3. 格式化 
4. 挂载 
5. 设置可以自动挂载 

------





###### 步骤一: 添加硬盘

 在【虚拟机】菜单中，选择【设置】，然后设备列表里添加硬盘，然后一路【下一步】，中间只有选择磁盘大小的地方需要修改，至到完成。然后重启系统（才能识别）！ ![1670985433690](.\linux.assets\挂载案例-添加硬盘-1.png)

------



###### 步骤二: 分区

- 命令  fdisk /dev/sdb  		  		 开始对/sdb 分区 

  - 后续命令

    m 显示命令列表 

    p 显示磁盘分区 同 fdisk –l 

    n 新增分区 

    d 删除分区 

    w 写入并退出 

     说明： 开始分区后输入 n，新增分区，然后选择 p ，分区类型为主分区。两次回车默认剩余全部空间。最后输入w写入分区并退出，若不保存退出输入 q。 

------



###### 步骤三: 格式化

命令 : mkfs -t ext4 /dev/sdb1 			

 其中 ext4 是分区类型 

-----



###### 步骤四: 挂载/卸载

- 描述 : 将一个分区与一个目录联系起来 
- 挂载命令 :  mount 设备名称 挂载目录 
- 例如： mount /dev/sdb1 /newdisk 
- 卸载命令 : umount 设备名称 或者 挂载目录 
- 例如： umount /dev/sdb1 或者 umount /newdisk 
- 注意: 用命令行挂载,重启后会失效 

-----



###### 步骤五: 设置可以自动挂载

 永久挂载: 通过修改/etc/fstab 实现挂载 

添加完成后 执行 mount –a 即刻生效 

------





####  磁盘情况查询 

######  系统整体磁盘

- 命令 : df -h 
- 实例 :                                                                ![1670986650562](.\linux.assets\磁盘情况查询-1.png)

------



######  指定目录的磁盘 

- 命令 :  du -h 要查询的目录						如果没指定目录默认当前目录

- 可选参数 : 

  - -s 指定目录占用大小汇总 
  - -h 带计量单位 
  - -a 含文件 
  - --max-depth=1 子目录深度 
  - -c 列出明细的同时，增加汇总值 

- 实例  :  

  - -s 指定目录占用大小汇总 -h 带计量单位 -a 含文件 --max-depth=1 子目录深度 -c 列出明细的同时，增加汇总值							

    du -hac --max-depth=1 /opt

     ![1670986936996](.\linux.assets\磁盘情况查询-2.png)

------





####  工作实用指令 

1.  统计/opt 文件夹下文件的个数 

   ls -l /opt | grep "^-" | wc -l

2. 统计/opt 文件夹下目录的个数 

   ls -l /opt | grep "^d" | wc -l 

3. 统计/opt 文件夹下文件的个数，包括子文件夹里的  

   ls -lR /opt | grep "^-" | wc -l

4. 统计/opt 文件夹下目录的个数，包括子文件夹里的 

   ls -lR /opt | grep "^d" | wc -l 

5. 以树状显示目录结构 tree 目录 ， 注意，如果没有 tree ,则使用 yum install tree 安装 

   tree /tmp

-------









#  网络配置 

####  查看网络 IP 和网关 

###### 查看 IP

![1671005710803](.\linux.assets\网络配置-查看ip和网关-1.png)

###### 查看网关

![1671005887383](.\linux.assets\网络配置-查看ip和网关-2.png)

-------





#### 查看 windows 环境的中 VMnet8 网络配置 - ipconfig

------



####  查看 linux 的网络配置 - ifconfig 

------





####  ping 测试主机之间网络连通性 

-  语法 : ping 目的主机 （功能描述：测试当前服务器是否可以连接目的主机） 

-  应用实例  : 

   测试当前服务器是否可以连接百度: ping www.baidu.com 

------





####  linux 网络环境配置 

######  第一种方法(自动获取)： 

​	说明：登陆后，通过界面的来设置自动获取 ip，特点：linux 启动后会自动获取 IP,缺点是每次自动获取的ip地址可能不一样 

------



######  第二种方法(指定 ip) 

- 说明 : 直接修改配置文件来指定 IP,并可以连接到外网(程序员推荐) 

- 命令 :  vim /etc/sysconfig/network-scripts/ifcfg-ens33 

  - 注意 : 配置文件不一定是 ems33 结尾

-  ifcfg-ens33 文件说明 

  DEVICE=eth0 #接口名（设备,网卡） 

  HWADDR=00:0C:2x:6x:0x:xx #MAC 地址 

  TYPE=Ethernet #网络类型（通常是 Ethemet） 

  UUID=926a57ba-92c6-4231-bacb-f27e5e6a9f44 #随机 id 

  \#系统启动的时候网络接口是否有效（yes/no） 

  ONBOOT=yes 

  #IP 的配置方法[none|static|bootp|dhcp]（引导时不使用协议|静态分配 IP|BOOTP 协议|DHCP 协议）BOOTPROTO=static 

  #IP 地址 

   IPADDR=192.168.200.130 

  #网关 

  GATEWAY=192.168.200.2 

  #域名解析器 

  DNS1=192.168.200.2 

-  重启网络服务或者重启系统生效 service network restart 、reboot 

------







####  设置主机名和 hosts 映射 

######  设置主机名 

1. 为了方便记忆，可以给 linux 系统设置主机名, 也可以根据需要修改主机名
2. 指令 hostname ： 查看主机名
3. 修改文件在 /etc/hostname 指定
4. 修改后，重启生效 

------



######  设置 hosts 映射 

- windows 在 C:\Windows\System32\drivers\etc\hosts 文件指定即可 
  - 案例: 192.168.113.200 Centos7001 			前面是ip地址,后面是ip对应的主机名
- linux 在 /etc/hosts 文件 指定 
  -  案例: 192.168.116.1 DESKTOP-GK0ULEH			前面是ip地址,后面是ip对应的主机名

------







####  主机名解析过程分析 

-  Hosts 是什么 

   一个文本文件，用来记录 IP 和 Hostname(主机名)的映射关系 

-  DNS 

  DNS，就是 Domain Name System 的缩写，翻译过来就是域名系统 

  是互联网上作为域名和 IP 地址相互映射的一个分布式数据库 

-  应用实例: 用户在浏览器输入了 www.baidu.com 

  1. 浏览器先检查浏览器缓存中有没有该域名解析 IP 地址，有就先调用这个 IP 完成解析；如果没有，就检查DNS解析器缓存，如果有直接返回 IP 完成解析。这两个缓存，可以理解为 本地解析器缓存
  2. 一般来说，当电脑第一次成功访问某一网站后，在一定时间内，浏览器或操作系统会缓存他的IP 地址（DNS解析记录）.如 在 cmd 窗口中输入 ipconfig /displaydns //DNS 域名解析缓存 ipconfig /flushdns //手动清理 dns 缓存 
  3. 如果本地解析器缓存没有找到对应映射，检查系统中 hosts 文件中有没有配置对应的域名IP 映射，如果有，则完成解析并返回。
  4. 如果 本地 DNS 解析器缓存 和 hosts 文件 中均没有找到对应的 IP，则到域名服务 DNS 进行解析域
  5. 示意图                                 ![1671354057303](.\linux.assets\主机域名解析过程.png)



---------------













# 进程管理

#### 显示系统执行的进程 

- 基本命令 : ps  命令是用来查看目前系统中，有哪些正在执行，以及它们执行的状况。可以不加任何参数 

- 命令参数

  | 命令  | 说明                     |
  | ----- | ------------------------ |
  | ps -a | 显示当前终端所有进程信息 |
  | ps -u | 以用户的格式显示进程信息 |
  | ps -x | 显示后台进程运行的参数   |
  | ps -e | 显示所有进程             |
  | ps -f | 全格式                   |

- 组合使用 ：ps -aux|grep xxx ，比如我看看有没有 sshd 服务 

- 显示的信息选项

  | 字段    | 说明                                                         |
  | ------- | ------------------------------------------------------------ |
  | USER    | 进程执行用户                                                 |
  | PID     | 进程号                                                       |
  | %CPU    | 占用CPU百分比                                                |
  | %MEM    | 占用物理内存百分比                                           |
  | VSZ     | 占用的虚拟内存大小（单位：KB）                               |
  | RSS     | 占用的物理内存大小（单位：KB）                               |
  | TTY     | 终端信息                                                     |
  | STAT    | 进程状态，其中 S-睡眠，s-表示该进程是会话的先导进程，N-表示进程拥有比普通优先级更低的优先级，R-正在运行，D-短期等待，Z-僵死进程，T-被跟踪或者被停止等等 |
  | START   | 进程的启动时间                                               |
  | TIME    | 占用CPU的时间,即进程使用 CPU 的总时间                        |
  | COMMAND | 进程名,执行改进程的指令, 启动进程所用的命令和参数，如果过长会被截断显示 |

- 案例 :  以全格式显示当前所有的进程，查看进程的父进程。 查看 sshd 的父进程信息 

  - 命令: ps -ef|grep sshd 
  - 说明: 是 BSD 风格 
    - UID：用户 ID 
    - PID：进程 ID 
    - PPID：父进程 ID 
    - C：CPU 用于计算执行优先级的因子。数值越大，表明进程是 CPU 密集型运算，执行优先级会降低；数值越小，表明进程是 I/O 密集型运算，执行优先级会提高 
    - STIME：进程启动的时间 
    - TTY：完整的终端名称 
    - TIME：CPU 时间 
    - CMD：启动进程所用的命令和参数 

------







####  终止进程 kill 和 killall 

-  基本语法 

  - kill [选项] 进程号（功能描述：通过进程号杀死/终止进程） 
  - killall 进程名称 （功能描述：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用） 

-  常用选项 

  -  -9 :表示强迫进程立即停止 

-  最佳实践 

  1. 踢掉某个非法登录用户 

     kill 进程号 , 比如 kill 11421 

  2. 终止远程登录服务 sshd, 在适当时候再次重启 sshd 服务 

     kill sshd 对应的进程号

     /bin/systemctl start sshd.service 

  3. 终止多个 gedit 

     演示 killall gedit

  4. 强制杀掉一个终端, 

     指令 kill -9 bash 对应的进程号 

---------------









####  查看进程树 pstree 

-  基本语法 :  pstree [选项] ,可以更加直观的来看进程信息 
-  常用选项 
  - -p :显示进程的 PID
  - -u :显示进程的所属用户 
-  应用实例 
  - 请你树状的形式显示进程的 pid pstree -p 
  - 请你树状的形式进程的用户 pstree -u 

------









####  服务(service)管理 

######  介绍 

 		服务(service) 本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其它程序的请求，比如(mysqld, sshd防火墙等)，因此我们又称为守护进程，是 Linux 中非常重要的知识点。 

------------------



######  service 管理指令 

1. service 服务名 [start | stop | restart | reload | status] 
2. 在 CentOS7.0 后 很多服务不再使用 service ,而是 systemctl (后面专门讲) 
3. service 指令管理的服务在 /etc/init.d 查看 

------



######  service 管理指令案例 

- 请使用 service 指令，查看，关闭，启动 network [注意：在虚拟系统演示，因为网络连接会关闭] 
  - 指令: 
    1. service network status 
    2. service network stop 
    3. service network start 

------------------



######  查看服务名

命令 :  

1. setup 			 可以看到全部。 
2.  ls -l /etc/init.d    看到 service 指令管理的服务 

--------------------



######  服务的运行级别(runlevel)

介绍

Linux 系统有 7 种运行级别(runlevel)：常用的是级别 3 和 5 运行级别 

0：系统停机状态，系统默认运行级别不能设为 0，否则不能正常启动 运行级别 

1：单用户工作状态，root 权限，用于系统维护，禁止远程登陆 运行级别 

2：多用户状态(没有 NFS)，不支持网络 运行级别 

3：完全的多用户状态(有 NFS)，无界面，登陆后进入控制台命令行模式 运行级别 

4：系统未使用，保留 运行级别 

5：X11 控制台，登陆后进入图形 GUI 模式 运行级别 

6：系统正常关闭并重启，默认运行级别不能设为 6，否则不能正常启动 



 开机的流程说明 

![1672296104269](D:\笔记\linux.assets\开机的流程说明.png)

---------------------



######  CentOS7 后运行级别说明 

 在 /etc/initab 进行了简化 ，如下: 

multi-user.target: analogous to runlevel 3 

graphical.target: analogous to runlevel 5 

查看当前运行级别:  systemctl get-default 

设置运行级别(下次启动就是设置的):  systemctl set-default TARGET.target 

-------------------



######  chkconfig 指令 

- 介绍 :  通过 chkconfig 命令可以给服务的各个运行级别设置自 启动/关闭 chkconfig 指令管理的服务在 /etc/init.d 查看 注意: Centos7.0 后，很多服务使用 systemctl 管理 

-  基本语法 

  1. 查看服务 :  chkconfig --list [| grep xxx]     或者      chkconfig 服务名 --list 
  2. 修改服务 : chkconfig --level 5 服务名 on/off 

-  案例演示 

  -  对 network 服务 进行各种操作, 把 network 在 3 运行级别,关闭自启动 

    关 : chkconfig --level 3 network off 

    开 : chkconfig --level 3 network on 

-  使用细节 

   chkconfig 重新设置服务后自启动或关闭，需要重启机器 reboot 生效. 

----------------



######  systemctl 管理指令 

-  基本语法： systemctl [start | stop | restart | status] 服务名 

  systemctl 指令管理的服务在 /usr/lib/systemd/system 查看 

- 设置服务的自启动状态 

  systemctl list-unit-files [ | grep 服务名] (查看服务开机启动状态, grep 可以进行过滤) 

  systemctl enable 服务名 (设置服务开机启动) 

  systemctl disable 服务名 (关闭服务开机启动) 

  systemctl is-enabled 服务名 (查询某个服务是否是自启动的) 

-  应用案例 

  -  查看当前防火墙的状况，关闭防火墙和重启防火墙。防火墙服务名 => firewalld.service 

    systemctl status firewalld; 

    systemctl stop firewalld; 

    systemctl start firewalld 

- 使用细节

  关闭或者启用防火墙后，立即生效。[telnet 测试 某个端口即可] 

  这种方式只是临时生效，当重启系统后，还是回归以前对服务的设置。 

  如果希望设置某个服务自启动或关闭永久生效，要使用 systemctl [enable|disable] 服务名  

----------------------



######  firewall 指令 

- 问题: 在真正的生产环境，往往需要将防火墙打开，但问题来了，如果我们把防火墙打开，那么外部请求数据包就不能跟服务器监听端口通讯。这时，需要打开指定的端口。比如 80、22、8080 等，这个又怎么做呢？ 

- 基本使用

  1. 打开端口: firewall-cmd --permanent --add-port=端口号/协议
  2. 关闭端口: firewall-cmd --permanent --remove-port=端口号/协议 
  3. 重新载入,才能生效 : firewall-cmd --reload 
  4. 查询端口是否开放: firewall-cmd --query-port=端口/协议 

-  应用案例 

  1. 启用防火墙， 测试 111 端口是否能 telnet , 

     telnet 192.168.113.200 111   失败

  2. 开放 111 端口 

     firewall-cmd --permanent --add-port=111/tcp ; 需要 firewall-cmd --reload

  3. 再次关闭 111 端口 

     firewall-cmd --permanent --remove-port=111/tcp ; 需要 firewall-cmd --reload 

-----------------------



###### top  动态监控进程 

-  介绍 

   top 与 ps 命令很相似。它们都用来显示正在执行的进程。Top 与 ps 最大的不同之处，在于top 在执行一段时间可以更新正在运行的的进程。 

-  基本语法 

   top [选项] 

  选项

  | 选项    | 功能                                         |
  | ------- | -------------------------------------------- |
  | -d 秒数 | 指定top命令每隔几秒更新。默认是3秒           |
  | -i      | 使top不显示任何闲置或者僵死进程。            |
  | -p      | 通过指定监控进程ID来仅仅监控某个进程的状态。 |

- 交互操作说明 

  | 操作 | 功能                          |
  | ---- | ----------------------------- |
  | P    | 以CPU使用率排序，默认就是此项 |
  | M    | 以内存的使用率排序            |
  | N    | 以PID排序                     |
  | q    | 退出top                       |

  

-  应用实例 

  1. 监视特定用户, 比如我们监控 tom 用户 

     top：输入此命令，按回车键，查看执行的进程。 

     u：然后输入“u”回车，再输入用户名，即可, 

  2. 终止指定的进程, 比如我们要结束 tom 登录 

     top：输入此命令，按回车键，查看执行的进程。

      k：然后输入“k”回车，再输入要结束的进程 ID 号 

  3. 指定系统状态更新的时间(每隔 10 秒自动更新), 默认是 3 秒 

     top -d 10 

------------------



######  监控网络状态  netstat 

-  基本语法 

   netstat [选项] 

-  选项说明 

   -an 按一定顺序排列输出

   -p 显示哪个进程在调用 

-  应用案例 

  请查看服务名为 sshd 的服务的信息。 

  netstat -anp | grep sshd 

---------------------------











#  RPM与YUM 

####  rpm 包的管理 

- 介绍 

  rpm 用于互联网下载包的打包及安装工具，它包含在某些 Linux 分发版中。它生成具有.RPM扩展名的文件。RPM是 RedHat Package Manager（RedHat 软件包管理工具）的缩写，类似 windows 的 setup.exe，这一文件格式名称虽然打上了 RedHat 的标志，但理念是通用的。 

  Linux 的分发版本都有采用（suse,redhat, centos 等等），可以算是公认的行业标准了。 

- rpm 包的简单查询指令 

  查询已安装的 rpm 列表 rpm –qa

  举例： 看看当前系统，是否安装了 firefox 

  指令: rpm -qa | grep firefox 

- rpm 包名基本格式 

   一个 rpm 包名：firefox-60.2.2-1.el7.centos.x86_64 

  名称:firefox 

  版本号：60.2.2-1 

  适用操作系统: el7.centos.x86_64 

  表示 centos7.x 的 64 位系统 

  如果是 i686、i386 表示 32 位系统，noarch 表示通用 

- rpm 包的其它查询指令： 

  rpm -qa :查询所安装的所有 rpm 软件包 

  rpm -qa | more :查询所安装的所有 rpm 软件包 (分页查看)

  rpm -qa | grep X :查询指定的 rpm 软件包

  rpm -q 软件包名 :查询软件包是否安装 

  案例：rpm -q firefox 

  rpm -qi 软件包名 ：查询软件包信息 

  案例: rpm -qi firefox 

  rpm -ql 软件包名 :查询软件包中的文件 

  案例： rpm -ql firefox 

  rpm -qf 文件全路径名 : 查询文件所属的软件包 

  案例 : rpm -qf /etc/passwd ; rpm -qf /root/install.log 

- 卸载 rpm 包 

   基本语法: rpm -e RPM包的名称 //erase 

   应用案例 :  删除 firefox 软件包

  ​	 				rpm -e firefox 

   细节讨论 : 

  1. 如果其它软件包依赖于您要卸载的软件包，卸载时则会产生错误信息。 

     如： $ rpm -e foo 

     removing these packages would break dependencies:foo is needed by bar-1.0-1

  2. 如果我们就是要删除 foo 这个 rpm 包，可以增加参数 --nodeps ,就可以强制删除，但是一般不推荐这样做，因为依赖于该软件包的程序可能无法运行 

     如：$ rpm -e --nodeps foo 

- 安装 rpm 包 

   基本语法 :  rpm -ivh RPM包全路径名称 

   参数说明 : 

  ​	i=install 安装 

  ​	v=verbose 提示 

  ​	h=hash 进度条 

   应用实例 : 

  ​	演示卸载和安装 firefox 浏览器 

  ​	rpm -e firefox ---------------卸载

  ​	rpm -ivh firefox -------------安装

-------------------------------------------







####  yum 

-  介绍： 

   Yum 是一个 Shell 前端软件包管理器。基于 RPM 包管理，能够从指定的服务器自动 下载 RPM 包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包。 

-  yum 的基本指令 

   查询 yum 服务器是否有需要安装的软件 

   yum list|grep xx

-  安装指定的 yum 包 

   yum install xxx 

-  yum 应用实例： 

  请使用 yum 的方式来安装 firefox 

  yum list | grep firefox 

  yum install firefox 

-----------------------













#  Shell 编程 

####  为什么要学习 Shell 编程 

1. Linux 运维工程师在进行服务器集群管理时，需要编写 Shell 程序来进行服务器管理。
2. 对于 JavaEE 和 Python 程序员来说，工作的需要，你的老大会要求你编写一些 Shell 脚本进行程序或者是服务器的维护，比如编写一个定时备份数据库的脚本。 
3. 对于大数据程序员来说，需要编写 Shell 程序来管理集群 

--------------------







####  Shell 是什么 

 Shell 是一个命令行解释器，它为用户提供了一个向 Linux 内核发送请求以便运行程序的界面系统级程序，用户可以用 Shell 来启动、挂起、停止甚至是编写一些程序。 

------------







####  Shell 脚本的执行方式 

######  脚本格式要求 

1. 脚本以#!/bin/bash 开头
2. 脚本需要有可执行权限 

----------------------------



######  编写第一个 Shell 脚本 

 需求说明：创建一个 Shell 脚本，输出 hello world! 

- vim hello.sh 
- #!/bin/bash 
- echo "hello,world~" 

-----------------



######  脚本的常用执行方式 

1. (输入脚本的绝对路径或相对路径) 说明：首先要赋予 helloworld.sh 脚本的+x 权限， 再执行脚本 比如 ./hello.sh 或者使用绝对路径 /root/shcode/hello.sh
2. (sh+脚本) 说明：不用赋予脚本+x 权限，直接执行即可。 比如 sh hello.sh , 也可以使用绝对路径 

-----------------







####  Shell 的变量 

****

######  Shell 变量介绍 

1. Linux Shell 中的变量分为，系统变量和用户自定义变量。
2. 系统变量：$HOME、$PWD、$SHELL、$USER 等等，比如： echo $HOME 等等..
3. 显示当前 shell 中所有变量：set 

--------------



######  shell 变量的定义 

-  shell 变量的定义 

  -  定义变量的规则 
    1. 变量名称可以由字母、数字和下划线组成，但是不能以数字开头。5A=200(×)
    2. 等号两侧不能有空格
    3. 变量名称一般习惯为大写， 这是一个规范，我们遵守即可 
  -  将命令的返回值赋给变量
    1. A=`date`反引号，运行里面的命令，并把结果返回给变量 A 
    2. A=$(date) 等价于反引号 

- 基本语法

  1. 定义变量：变量名=值 
  2. 撤销变量：unset 变量
  3. 声明静态变量：readonly 变量，注意：不能 unset 

-  快速入门 

  1. 定义变量 A

     A=100
     echo A=$A

  2. 撤销变量 A 

     unset A

  3. 声明静态的变量 B=2，不能 unset 

     readonly B=2
     echo "B=$B"

  4.  将指令返回的结果赋给变量 

     ```shell
     C=`date` 
     D=$(date) 
     echo "C=$C" 
     echo "D=$D" 
     ```

  5.  使用环境变量 TOMCAT_HOME 

      echo "tomcat_home=$TOMCAT_HOME" 

  6.  可把变量提升为全局环境变量，可供其他 shell 程序使用 

------------------







####  设置环境变量 

######  基本语法 

1. export 变量名=变量值 （功能描述：将 shell 变量输出为环境变量/全局变量）
2. source 配置文件 （功能描述：让修改后的配置信息立即生效） 
3. echo $变量名 （功能描述：查询环境变量的值） 

---------------------------



######  快速入门

1. 在/etc/profile 文件中定义 TOMCAT_HOME 环境变量

   vim /etc/profile  --打开环境变量配置文件

   export TOMCAT_HOME=/opt/tomcat  --在配置文件中输入

2. 查看环境变量 TOMCAT_HOME 的值 

   source /etc/profile  --刷新配置文件

   echo  $TOMCAT_HOME  --查看环境变量的值

3. 在另外一个 shell 程序中使用 TOMCAT_HOME 

   打开一个shell文件和普通变量使用方法一样

   比如 ： echo "TOMCAT_HOME=$TOMCAT_HOME"

   

   注意：在输出 TOMCAT_HOME 环境变量前，需要让其生效(也就是编辑之后刷新一下这个文件) 

   source /etc/profile 

   shell 脚本的多行注释 :<<!   内容  !

-------------------------







####  位置参数变量 

######  介绍 

 当我们执行一个 shell 脚本时，如果希望获取到命令行的参数信息，就可以使用到位置参数变量比如 ： ./myshell.sh 100 200 , 这个就是一个执行 shell 的命令行，可以在 myshell 脚本中获取到参数信息 

-----------------



######  基本语法 

-  $n （功能描述：n 为数字，$0 代表命令本身，$1-$9 代表第一到第九个参数，十以上的参数，十以上的参数需要用大括号包含，如${10}） 
- $* （功能描述：这个变量代表命令行中所有的参数，$*把所有的参数看成一个整体）
- $@（功能描述：这个变量也代表命令行中所有的参数，不过$@把每个参数区分对待）
- $#（功能描述：这个变量代表命令行中所有参数的个数） 

------------------



###### 案例

 编写一个 shell 脚本 position.sh ， 在脚本中获取到命令行的各个参数信息 

![1675070544352](D:\笔记\linux.assets\位置参数变量—1.png)

-----------------------------































# linux root 用户密码找回

1. 首先，启动系统，进入开机界面，在界面中按“e”进入编辑界面。![](.\linux.assets\linux_root_用户密码找回_1.png)
2. 进入编辑界面，使用键盘上的上下键把光标往下移动，找到以““Linux16”开头内容所在的行数”，在行的最后面输入：init=/bin/sh                    ![](.\linux.assets\linux_root_用户密码找回_2.png)
3. 接着，输入完成后，直接按快捷键：Ctrl+x 进入**单用户模式**。
4. 2接着，在光标闪烁的位置中输入：mount -o remount,rw /（注意：各个单词间有空格），完成后按键盘的回车键（Enter）。如图                                                                                                       ![1670597135784](.\linux.assets\linux_root_用户密码找回_3.png)
5. 在新的一行最后面输入：passwd， 完成后按键盘的回车键（Enter）。输入密码，然后再次确认密码即可(密码长度最好8位以上,但不是必须的), 密码修改成功后，会显示passwd.....的样式，说明密码修改成功![1670597355312](.\linux.assets\linux_root_用户密码找回_4.png)
6. 接着，在鼠标闪烁的位置中（最后一行中）输入：touch /.autorelabel（注意：touch与 /后面有一个空格），完成后按键盘的回车键（Enter）
7. 继续在光标闪烁的位置中，输入：exec /sbin/init（注意：exec与 /后面有一个空格），完成后按键盘的回车键（Enter）,等待系统自动修改密码(韩顺平提示：这个过程时间可能有点长，耐心等待)，完成后，系统会自动重启, 新的密码生效了                                                                                ![1670597420888](.\linux.assets\linux_root_用户密码找回_5.png)

------





# linux系统设置中文

1. 查看当前系统语言
   - 登陆linux系统打开操作终端之后，输入 echo $LANG 可以查看当前使用的系统语言
2. 查看安装的语言包
   - 查看是否有中文语言包可以在终端输入 locale 命令，如有 zh cn 表示已经安装了中文语言
3.  如果没有中文语言呢 
   -  可以通过网上下载安装中文语言包 yum groupinstall chinese-support 

